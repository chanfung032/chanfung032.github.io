
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>TLSâ€”â€”åŠ å¯†ä¿¡é“çš„å»ºç«‹ &#8212; Feng&#39;s blog 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TLSâ€”â€”è¯ä¹¦ä¿¡ä»»é“¾" href="tls-certificate.html" />
    <link rel="prev" title="Imago Intentional Dialogue" href="imago-intentional-dialogue.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tls-jia-mi-xin-dao-de-jian-li">
<h1>TLSâ€”â€”åŠ å¯†ä¿¡é“çš„å»ºç«‹<a class="headerlink" href="#tls-jia-mi-xin-dao-de-jian-li" title="Permalink to this headline">Â¶</a></h1>
<p>ç®€æ˜“ç‰ˆ TLS å®¢æˆ·ç«¯å®ç°ï¼š <a class="reference external" href="https://github.com/chanfung032/labs/blob/master/tls/tls13.go">https://github.com/chanfung032/labs/blob/master/tls/tls13.go</a></p>
<section id="gai-shu">
<h2>æ¦‚è¿°<a class="headerlink" href="#gai-shu" title="Permalink to this headline">Â¶</a></h2>
<p>ä¸€ä¸ª TLS åŠ å¯†ä¿¡é“çš„å»ºç«‹ï¼ˆHandshakeï¼‰ä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªå†…å®¹ï¼š</p>
<ul class="simple">
<li><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•åå•†å‡ºä¸€ä¸ªå…±äº«å¯†é’¥ï¼Œåç»­æ•°æ®ä¼ è¾“ä½¿ç”¨è¯¥å¯†é’¥+å¯¹ç§°åŠ å¯†ç®—æ³•æ¥åŠ å¯†ã€‚</p></li>
<li><p>æœåŠ¡ç«¯é€šè¿‡è¯ä¹¦ï¼ˆCertificateï¼‰æ¥è¯æ˜è‡ªå·±å°±æ˜¯å®¢æˆ·ç«¯æƒ³è¦è¿æ¥çš„æœåŠ¡ç«¯è€Œä¸æ˜¯ä»€ä¹ˆä¸­é—´äººä¹‹ç±»çš„ã€‚</p></li>
</ul>
<p>ä¸‹é¢æˆ‘ä»¬ä»¥ TLS 1.3 çš„ Handshake æ¥è¯¦ç»†è¯´æ˜ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼ˆé€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥æ‰“å°å‡ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äº¤äº’çš„æŠ¥æ–‡ï¼‰ã€‚</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>openssl s_client -connect cloudflare.com:443 -showcerts -msg
</pre></div>
</div>
</section>
<section id="tls-1-3">
<h2>TLS-1.3<a class="headerlink" href="#tls-1-3" title="Permalink to this headline">Â¶</a></h2>
<p>TLS 1.3 æ•´ä¸ªçš„ Handshake è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img alt="_images/tls-13.svg" src="_images/tls-13.svg" /><p>TLS å°†æ¶ˆæ¯å°è£…æˆä¸€ä¸ªä¸€ä¸ªçš„ Record æ¥ä¼ è¾“ï¼Œæ¯ä¸ª Record åŒ…å« 1 ä¸ªæˆ–å¤šä¸ªæ¶ˆæ¯ï¼Œ Record æ ¼å¼å¦‚ä¸‹ï¼š</p>
<img alt="_images/tls-record.svg" src="_images/tls-record.svg" /><section id="clienthello">
<h3>ClientHello<a class="headerlink" href="#clienthello" title="Permalink to this headline">Â¶</a></h3>
<p>TLS Handshake ä»¥å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ ClientHello å¼€å§‹ã€‚å®¢æˆ·ç«¯ä½¿ç”¨ x25519 æ¤­åœ†æ›²çº¿ç®—æ³•ç”Ÿæˆä¸€å¯¹å…¬é’¥/å¯†é’¥ï¼Œç„¶åå°†å…¬é’¥æ”¾åˆ° ClientHello ä¸­å‘é€ç»™æœåŠ¡ç«¯ã€‚</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>16 Record ç±»å‹ï¼šHandshake
  03 01 Record åè®®ç‰ˆæœ¬ â€œ3ï¼Œ1â€ï¼Œä¹Ÿå°±æ˜¯ TLS-1.0
  00 ca å‰©ä½™æ¶ˆæ¯é•¿åº¦ï¼ˆä¸‹é¢ç©ºç™½çš„å­—æ®µåŸºæœ¬éƒ½æ˜¯é•¿åº¦ï¼Œçœç•¥ä¸æ ‡æ³¨äº†ï¼‰

01 Handshake æ¶ˆæ¯ï¼Œç±»å‹ 0x01ï¼šclient hello
00 00 c6

03 03 å®¢æˆ·ç«¯ä½¿ç”¨çš„ TLS ç‰ˆæœ¬ï¼Œâ€œ3ï¼Œ3â€ï¼Œä¹Ÿå°±æ˜¯ TLS-1.2

00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f éšæœºæ•°

20 Session ID é•¿åº¦ï¼ˆdecrecatedï¼‰
  e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef
  f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff Session ID

00 06 æ”¯æŒçš„åŠ å¯†å¥—ä»¶ï¼ˆcipher suiteï¼‰
  13 01 TLS_AES_128_GCM_SHA256
  13 02 TLS_AES_256_GCM_SHA384
  13 03 TLS_CHACHA20_POLY1305_SHA256

01 00 0x01 è¡¨ç¤ºå‹ç¼©æ–¹æ³•ï¼Œ0x00 è¡¨ç¤ºä¸å‹ç¼©

00 77 æ‰©å±•ï¼ˆExtensionï¼‰å­—æ®µé•¿åº¦

00 00  SNI æ‰©å±•å­—æ®µ
 00 18
  00 16 ç¬¬ä¸€ä¸ªæ¡ç›®çš„å­—æ®µé•¿åº¦ï¼ˆå¯ä»¥æœ‰å¤šæ¡ï¼‰
   00    æ¡ç›®çš„ç±»å‹ä¸º â€œDNS Hostnameâ€
   00 13 Hostname é•¿åº¦
    65 78 61 6d 70 6c 65 2e 75 6c 66 68 65 69 6d 2e 6e 65 74 Hostname

00 0a â€œæ”¯æŒçš„æ¤­åœ†æ›²çº¿ç±»å‹â€æ‰©å±•å­—æ®µ
 00 08
  00 06
   00 1d x25519
   00 17 secp256r1
   00 18 secp384r1

00 0d â€œå®¢æˆ·ç«¯æ”¯æŒçš„ç­¾åç®—æ³•â€æ‰©å±•å­—æ®µ
 00 14
  00 12
   04 03 ECDSA-SECP256r1-SHA256
   08 04 RSA-PSS-RSAE-SHA256
   04 01 RSA-PKCS1-SHA256
   05 03 ECDSA-SECP384r1-SHA384
   08 05 RSA-PSS-RSAE-SHA384
   05 01 RSA-PKCS1-SHA386
   08 06 RSA-PSS-RSAE-SHA512
   06 01 RSA-PKCS1-SHA512
   02 01 RSA-PKCS1-SHA1

00 33 â€œKey Shareâ€æ‰©å±•å­—æ®µ
 00 26
  00 24
   00 1d ä½¿ç”¨ curve25519 æ¥äº¤æ¢å¯†é’¥
   00 20 å¯†é’¥é•¿åº¦
     35 80 72 d6 36 58 80 d1 ae ea 32 9a df 91 21 38
     38 51 ed 21 a2 8e 3b 75 e9 65 d0 d2 cd 16 62 54 å®¢æˆ·ç«¯çš„å…¬é’¥

00 2d 00 02 01 01

00 2b â€œæ”¯æŒçš„ TLS ç‰ˆæœ¬â€æ‰©å±•å­—æ®µ
00 03
  02
   03 04 TLS 1.3 æ ‡ç¤ºäº†å®¢æˆ·ç«¯å¸Œæœ›ä½¿ç”¨ TLS 1.3
</pre></div>
</div>
<p>ä¸ºäº†å…¼å®¹</p>
<ul class="simple">
<li><p>å‘é€ client hello æ¶ˆæ¯ä½¿ç”¨çš„ Record ç‰ˆæœ¬æ˜¯ TLS-1.0 ç‰ˆæœ¬ï¼Œè¿™æ ·å³ä½¿æœåŠ¡ç«¯ç‰ˆæœ¬ä½ä¹Ÿèƒ½è§£æè¿™ä¸ª Record å¹¶è¿”å›é”™è¯¯ã€‚</p></li>
<li><p>å®¢æˆ·ç«¯ TLS æ¡æ‰‹åè®®ä½¿ç”¨ TLS-1.2ï¼Œä½†åœ¨æ‰©å±•å­—æ®µä¸­å£°æ˜è‡ªå·±æ”¯æŒ TLS-1.3ã€‚è¿™æ ·ä½ç‰ˆæœ¬çš„ Proxy ä¸ä¼šå› ä¸ºç‰ˆæœ¬ä¸æ”¯æŒå°±ä¸¢æ‰åŒ…ã€‚</p></li>
</ul>
</section>
<section id="serverhello">
<h3>ServerHello<a class="headerlink" href="#serverhello" title="Permalink to this headline">Â¶</a></h3>
<p>æœåŠ¡ç«¯åŒæ ·ç”Ÿæˆä¸€å¯¹å…¬é’¥å¯†é’¥å¹¶å°†å…¬é’¥é€šè¿‡ ServerHello å‘é€ç»™å®¢æˆ·ç«¯ã€‚</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>16 Record ç±»å‹ï¼šHandshake
 03 03 Record åè®®ç‰ˆæœ¬ â€œ3ï¼Œ3â€ï¼Œä¹Ÿå°±æ˜¯ TLS-1.2 ï¼ˆå‡çº§äº†ï¼‰
 00 7a

02 Handshake æ¶ˆæ¯ç±»å‹ 0x01ï¼Œserver hello
00 00 76

03 03 ä½¿ç”¨çš„ Handshake æ¶ˆæ¯ç‰ˆæœ¬ TLS 1.2

70 71 72 73 74 75 76 77 78 79 7a 7b 7c 7d 7e 7f
80 81 82 83 84 85 86 87 88 89 8a 8b 8c 8d 8e 8f éšæœºæ•°

20 Session IDï¼ŒåŸæ ·è¿”å›
 e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef
 f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff

13 01 ä½¿ç”¨ TLS_AES_128_GCM_SHA256 åŠ å¯†å¥—ä»¶

00 å‹ç¼©æ–¹æ³•ï¼Œä¸å‹ç¼©

00 2e æ‰©å±•å­—æ®µé•¿åº¦

00 33 â€œKey Shareâ€æ‰©å±•å­—æ®µ
 00 24
  00 1d
   00 20
    9f d7 ad 6d cf f4 29 8d d3 f9 6d 5b 1b 2a f9 10
    a0 53 5b 14 88 d7 f8 fa bb 34 9a 98 28 80 b6 15 æœåŠ¡ç«¯å…¬é’¥

00 2b â€œæ”¯æŒçš„ TLS ç‰ˆæœ¬â€æ‰©å±•å­—æ®µ
 00 02
  03 04 ğŸ‘Œï¼Œæˆ‘ä»¬ä½¿ç”¨ TLS 1.3
</pre></div>
</div>
<p>æ¥ä¸‹æ¥ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä½¿ç”¨ curve25519 ç®—æ³•å°†å¯¹ç«¯çš„å…¬é’¥å’Œè‡ªå·±çš„ç§é’¥ç›¸ä¹˜å¾—åˆ°ä¸€ä¸ªå…±äº«å¯†é’¥ï¼ˆåŸç†è§ <a class="reference internal" href="elliptic-curve-cryptography.html#ecdh"><span class="std std-ref">ECDH åŠ å¯†ç®—æ³•</span></a> ï¼‰ ã€‚</p>
<p>å¾—åˆ°äº†å¯†é’¥åï¼Œä¸¤ç«¯å¹¶ä¸æ˜¯ç›´æ¥ä½¿ç”¨è¿™ä¸ªå¯†é’¥æ¥åŠ å¯†æ•°æ®ï¼Œè€Œæ˜¯ä½¿ç”¨ HKDF <a class="footnote-reference brackets" href="#id2" id="id1">*</a> å‡½æ•°å°†è¿™ä¸ªå¯†é’¥æ˜ å°„ä¸ºä¸‹é¢ä¸€ç³»åˆ—æ›´å®‰å…¨çš„å¯†é’¥ï¼š</p>
<ul class="simple">
<li><p>handshake_secret</p></li>
<li><p>client handshake traffic secret</p></li>
<li><p>client handshake key</p></li>
<li><p>client handshake IV</p></li>
<li><p>server handshake traffic secret</p></li>
<li><p>server handshake key</p></li>
<li><p>server handshake IV</p></li>
</ul>
<p>å…¶ä¸­</p>
<ul class="simple">
<li><p>client handshake key/IV ä¼šä½œä¸ºå‚æ•°ä¼ ç»™ aes_128_gcm ç®—æ³•ç”¨æ¥åŠ å¯†è§£å¯†æ¥ä¸‹æ¥çš„å®¢æˆ·ç«¯ä¸Šè¡Œ Handshake æ¶ˆæ¯ã€‚</p></li>
<li><p>server handshake key/IV ä¼šä½œä¸ºå‚æ•°ä¼ ç»™ aes_128_gcm ç®—æ³•ç”¨æ¥åŠ å¯†è§£å¯†æ¥ä¸‹æ¥çš„æœåŠ¡å™¨ä¸‹è¡Œ Handshake æ¶ˆæ¯ã€‚</p></li>
</ul>
<p>handshake çš„ key ä¸å˜ï¼Œä½† IV æ¯å‘é€ä¸€ä¸ªåŒ…å˜åŒ–ä¸€æ¬¡ï¼Œä¿è¯æ¯æ¬¡å¯¹ç§°ç®—æ³•ç”¨çš„å¯†é’¥éƒ½ä¸ä¸€æ ·ï¼ˆIV æ˜¯ initialization vector çš„æ„æ€ï¼Œä¸æ˜¯ç½—é©¬æ•°å­— 4ï¼‰ã€‚</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">*</a></span></dt>
<dd><p>åœ¨å¯†ç å­¦ä¸­ï¼ŒKDF(Key derivation functionï¼Œå¯†é’¥æ´¾ç”Ÿå‡½æ•°) ä½¿ç”¨ä¼ªéšæœºå‡½æ•°ä»è¯¸å¦‚ä¸»å¯†é’¥æˆ–å¯†ç çš„ç§˜å¯†å€¼ä¸­æ´¾ç”Ÿå‡ºä¸€ä¸ªæˆ–å¤šä¸ªå¯†é’¥ã€‚KDFå¯ç”¨äºå°†å¯†é’¥æ‰©å±•ä¸ºæ›´é•¿çš„å¯†é’¥æˆ–è·å–æ‰€éœ€æ ¼å¼çš„å¯†é’¥ã€‚HKDF å°±æ˜¯åŸºäº HMAC çš„ KDF å‡½æ•°</p>
</dd>
</dl>
</section>
<section id="serverchangecipherspec">
<h3>ServerChangeCipherSpec<a class="headerlink" href="#serverchangecipherspec" title="Permalink to this headline">Â¶</a></h3>
<p>æœåŠ¡å™¨æ¥ä¸‹æ¥ä¼šå‘é€ä¸€ä¸ª ServerChangeCipherSpec æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼Œè¿™ä¸ªæ¶ˆæ¯åœ¨ TLS 1.3 ä¸­æ²¡æœ‰ç”¨ï¼Œåªæ˜¯ä¸ºäº†å…¼å®¹ä»¥å‰åè®®ç”¨ã€‚</p>
<p>ä»è¿™ä¸ªæ¶ˆæ¯ä¹‹åï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´æ‰€æœ‰çš„é€šä¿¡éƒ½æ˜¯åŠ å¯†çš„ã€‚</p>
</section>
<section id="certificate-certificate-verify-serverhandshakefinished">
<h3>{â€¦,Certificate,Certificate Verify,ServerHandshakeFinished}<a class="headerlink" href="#certificate-certificate-verify-serverhandshakefinished" title="Permalink to this headline">Â¶</a></h3>
<p>æ¥ä¸‹æ¥æœåŠ¡ç«¯ä½¿ç”¨ä¸€ä¸ª Record å‘å®¢æˆ·ç«¯å‘é€ä»¥ä¸‹ 4 ä¸ªæ¶ˆæ¯ï¼ˆåŠ å¯†çš„ï¼‰ï¼š</p>
<ul class="simple">
<li><p>Server Encrypted Extensions</p></li>
<li><p>Certificate æœåŠ¡ç«¯çš„è¯ä¹¦ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡è¯ä¹¦ä¿¡ä»»é“¾éªŒè¯è¯ä¹¦æ˜¯å¦å¯ä¿¡ï¼Œè¯¦ç»†è§ <a class="reference internal" href="tls-certificate.html"><span class="doc">TLSâ€”â€”è¯ä¹¦ä¿¡ä»»é“¾</span></a> ã€‚</p></li>
<li><p>Certificate Verify ä½¿ç”¨æœåŠ¡ç«¯è¯ä¹¦çš„ç§é’¥å¯¹æœ¬æ¶ˆæ¯ä¹‹å‰æ‰€æœ‰ Handshake æ¶ˆæ¯çš„ hash åŠ å¯†åçš„æ•°æ®ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡è¯ä¹¦çš„å…¬é’¥è§£å¯†è¿™æ®µæ•°æ®åéªŒè¯æ˜¯å¦ä¸€è‡´æ¥éªŒè¯æœåŠ¡ç«¯æ˜¯å¦æ˜¯è¯ä¹¦çš„ Ownerã€‚</p></li>
<li><p>ServerHandshakeFinished å¯¹æœ¬æ¶ˆæ¯ä»¥å‰ Handshake ä¿¡æ¯çš„ hashï¼Œå‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯éªŒè¯ä¸€è‡´ï¼Œç”¨ä»¥ç¡®è®¤å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„é€šä¿¡æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ã€‚</p></li>
</ul>
<p>é€šè¿‡ä¹‹å‰ ServerHello åè®¡ç®—å¾—å‡ºçš„ handshake_secret å’Œ åˆ°æ­¤ä¸ºæ­¢æ‰€æœ‰ Handshake æ¶ˆæ¯çš„ SHA256ï¼Œä½¿ç”¨ HKDF æˆ‘ä»¬å¯ä»¥è®¡ç®—å¾—åˆ°ä¸‹é¢ç”¨æ¥ä¼ è¾“å®é™… Application Data çš„å¯†é’¥ï¼š</p>
<ul class="simple">
<li><p>client application key</p></li>
<li><p>server application key</p></li>
<li><p>client application IV</p></li>
<li><p>server application IV</p></li>
</ul>
<p>Application Data åŠ å¯†æ–¹å¼åŒ Handshake ä¸€æ ·ã€‚</p>
</section>
<section id="clientchangecipherspec">
<h3>ClientChangeCipherSpec<a class="headerlink" href="#clientchangecipherspec" title="Permalink to this headline">Â¶</a></h3>
<p>åŒ ServerChangeCipherSpec ä¸€æ ·ï¼Œæ²¡æœ‰ç”¨ï¼Œåªåšå…¼å®¹ç”¨ã€‚</p>
</section>
<section id="clienthandshakefinished">
<h3>ClientHandshakeFinished<a class="headerlink" href="#clienthandshakefinished" title="Permalink to this headline">Â¶</a></h3>
<p>åŒ ServerHandshakeFinished å¯¹æœ¬æ¶ˆæ¯ä»¥å‰ Handshake ä¿¡æ¯çš„ hashï¼Œå‘é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯éªŒè¯ä¸€è‡´ï¼Œç”¨ä»¥ç¡®è®¤å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„é€šä¿¡æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ã€‚</p>
<p>åˆ°æ­¤ï¼ŒTLS 1.3 çš„æ¡æ‰‹å°±å®Œæˆäº†ï¼ŒåŠ å¯†ä¿¡é“å»ºç«‹å®Œæ¯•ï¼Œæ¥ä¸‹æ¥æ—¢å¯ä»¥å®‰å…¨çš„é€šä¿¡äº†ã€‚</p>
<p>å‚è€ƒï¼š</p>
<ul class="simple">
<li><p><a class="reference external" href="https://commandlinefanatic.com/cgi-bin/showarticle.cgi?article=art080">A walkthrough of a TLS 1.3 handshake</a></p></li>
<li><p><a class="reference external" href="https://tls13.ulfheim.net/">The New Illustrated TLS Connection - Every byte explained and reproduced</a></p></li>
<li><p>TLS 1.3 Protocol <a class="reference external" href="https://tools.ietf.org/html/rfc8446">https://tools.ietf.org/html/rfc8446</a></p></li>
<li><p>Go TLS æºç ï¼š<a class="reference external" href="https://golang.org/src/crypto/tls/">https://golang.org/src/crypto/tls/</a></p></li>
<li><p><a class="reference external" href="https://blog.cloudflare.com/rfc-8446-aka-tls-1-3/">https://blog.cloudflare.com/rfc-8446-aka-tls-1-3/</a></p></li>
<li><p><a class="reference external" href="https://wiki.openssl.org/index.php/EVP_Authenticated_Encryption_and_Decryption">https://wiki.openssl.org/index.php/EVP_Authenticated_Encryption_and_Decryption</a></p></li>
<li><p><a class="reference external" href="https://crypto.stackexchange.com/questions/3965/what-is-the-main-difference-between-a-key-an-iv-and-a-nonce">https://crypto.stackexchange.com/questions/3965/what-is-the-main-difference-between-a-key-an-iv-and-a-nonce</a></p></li>
<li><p><a class="reference external" href="https://zhuanlan.zhihu.com/p/24678857">å®ç”¨å¯†ç å­¦å·¥å…·â€”â€”KDF</a></p></li>
</ul>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">TLSâ€”â€”åŠ å¯†ä¿¡é“çš„å»ºç«‹</a><ul>
<li><a class="reference internal" href="#gai-shu">æ¦‚è¿°</a></li>
<li><a class="reference internal" href="#tls-1-3">TLS-1.3</a><ul>
<li><a class="reference internal" href="#clienthello">ClientHello</a></li>
<li><a class="reference internal" href="#serverhello">ServerHello</a></li>
<li><a class="reference internal" href="#serverchangecipherspec">ServerChangeCipherSpec</a></li>
<li><a class="reference internal" href="#certificate-certificate-verify-serverhandshakefinished">{â€¦,Certificate,Certificate Verify,ServerHandshakeFinished}</a></li>
<li><a class="reference internal" href="#clientchangecipherspec">ClientChangeCipherSpec</a></li>
<li><a class="reference internal" href="#clienthandshakefinished">ClientHandshakeFinished</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tls-protocol.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, chanfung032.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/tls-protocol.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>